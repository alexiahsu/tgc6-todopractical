{% extends 'layout.template.html' %}

{%block title%}Todo List{%endblock%}

{%block content%}
<h2>Tasks</h2>

<a href="{{url_for('create_task')}}" class="btn btn-primary">New Task</a>

<ul class="list-group mt-3">
{%for t in tasks%}
    <li class="list-group-item">
    <input type="checkbox" class="task" data-task-id="{t._id}" />
    {{t.task_name}}
    </li>
{%endfor%}
</ul>
{%endblock%}

{%block js%}
<script>
$(function(){
    $('.task-checkbox').change(function(){
        let task_id = $(this).data('task-id')
        $.ajax({
            'url': "{{url_for('check_task')}}",
            'datatype': 'json',
            'contentType': 'application/json',
            'data': JSON.stringify{
                'task_id': task_id
            },
            'type': 'PATCH'
        })
    })
})
</script>
{%endblock%}